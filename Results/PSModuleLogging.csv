TimeGenerated,EventID,ContextINFO,Payload
2021-08-25 19:50:29,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1
        Host ID = e534f53d-6220-4355-88b2-2d4226399e05
        Host Application = powershell -nop -ep bypass -c $f=[io.file]::ReadAllText('C:\Windows\Setup\Scripts\HWID_Activation_AIO.cmd') -split ':bat2file\:.*';iex ($f[1]);X 3;X 4;
        Engine Version = 5.1.19041.1
        Runspace ID = ce7efdae-da5b-4182-a2f1-38faedeca585
        Pipeline ID = 1
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = 
        Command Path = 
        Sequence Number = 16
        User = WORKGROUP\SYSTEM
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""Language""; value=""CSharp""
ParameterBinding(Add-Type): name=""TypeDefinition""; value="" using System.IO; public class BAT85{ public static void Decode(string tmp, string s) { MemoryStream ms=new MemoryStream(); n=0;
 byte[] b85=new byte[255]; string a85=""0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!#$&()+,-./;=?@[]^_{"
2021-08-29 01:00:32,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = 757db2ec-f848-4b8b-8d98-42bff0807fdd
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1'
        Engine Version = 5.1.19041.1151
        Runspace ID = ca42ffc1-9476-4d84-bbb5-43badc09c996
        Pipeline ID = 1
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1
        Command Path = 
        Sequence Number = 19
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""AssemblyName""; value=""System.Windows.Forms""
"
2021-08-29 01:36:01,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = ea75c87a-2491-4b16-ab97-2c9c600fa4f0
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1'
        Engine Version = 5.1.19041.1151
        Runspace ID = 4313be45-bbfc-47dc-bbfb-b8ba886f4a04
        Pipeline ID = 1
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1
        Command Path = 
        Sequence Number = 19
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""AssemblyName""; value=""System.Windows.Forms""
"
2021-08-29 01:38:11,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = e097dde4-6fec-4eb3-957b-91f1a5bb4ae7
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1'
        Engine Version = 5.1.19041.1151
        Runspace ID = 0c715806-9277-48db-b9bc-ef499744a5da
        Pipeline ID = 1
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1
        Command Path = 
        Sequence Number = 19
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""AssemblyName""; value=""System.Windows.Forms""
"
2021-08-29 01:40:31,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = 2157b49b-0e24-4e93-84b4-9a68335e189e
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -Command if((Get-ExecutionPolicy ) -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; & 'C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1'
        Engine Version = 5.1.19041.1151
        Runspace ID = 8c4ae416-e2ff-455b-8aa7-fe4e723f3a86
        Pipeline ID = 1
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1
        Command Path = 
        Sequence Number = 19
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""AssemblyName""; value=""System.Windows.Forms""
"
2021-08-29 01:40:47,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = a9b4843c-66c7-4ee9-9281-63dfcacd3b90
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.19041.1151
        Runspace ID = ce547b84-3cfb-4a83-b5ec-2408f506cb9e
        Pipeline ID = 129
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Users\sayed\Downloads\EventLog-parser-main\EventLogGUI.ps1
        Command Path = 
        Sequence Number = 83
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""AssemblyName""; value=""System.Windows.Forms""
"
2021-08-29 01:52:02,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = a9b4843c-66c7-4ee9-9281-63dfcacd3b90
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.19041.1151
        Runspace ID = ce547b84-3cfb-4a83-b5ec-2408f506cb9e
        Pipeline ID = 162
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\1.0.0.1\PSModule.psm1
        Command Path = 
        Sequence Number = 85
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""ReferencedAssemblies""; value=""System.Management.Automation, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, ...""
ParameterBinding(Add-Type): name=""TypeDefinition""; value=""using System; 
using System.Net;
using System.Management.Automation;
using Microsoft.Win32.SafeHandles;
using System.Security.Cryptography;
using System.Runtime.InteropServices;
using System.Runtime.ConstrainedExecution;
using System.Runtime.Versioning;
using System.Security;

namespace Microsoft.PowerShell.Commands.PowerShellGet 
{ 
    public static class Telemetry  
    { 
        public static void TraceMessageArtifactsNotFound(string[] artifactsNotFound, string operationName) 
        { 
            Microsoft.PowerShell.Telemetry.Internal.TelemetryAPI.TraceMessage(operationName, new { ArtifactsNotFound = artifactsNotFound });
        }         
        
        public static void TraceMessageNonPSGalleryRegistration(string sourceLocationType, string sourceLocationHash, string installationPolicy, string packageManagementProvider, string publishLocationHash, string scriptSourceLocationHash, string scriptPublishLocationHash, string operationName) 
        { 
            Microsoft.PowerShell.Telemetry.Internal.TelemetryAPI.TraceMessage(operationName, new { SourceLocationType = sourceLocationType, SourceLocationHash = sourceLocationHash, InstallationPolicy = installationPolicy, PackageManagementProvider = packageManagementProvider, PublishLocationHash = publishLocationHash, ScriptSourceLocationHash = scriptSourceLocationHash, ScriptPublishLocationHash = scriptPublishLocationHash });
        }         
        
    }
    
    /// <summary>
    /// Used by Ping-Endpoint function to supply webproxy to HttpClient
    /// We cannot use System.Net.WebProxy because this is not available on CoreClr
    /// </summary>
    public class InternalWebProxy : IWebProxy
    {
        Uri _proxyUri;
        ICredentials _credentials;

        public InternalWebProxy(Uri uri, ICredentials credentials)
        {
            Credentials = credentials;
            _proxyUri = uri;
        }

        /// <summary>
        /// Credentials used by WebProxy
        /// </summary>
        public ICredentials Credentials
        {
            get
            {
                return _credentials;
            }
            set
            {
                _credentials = value;
            }
        }

        public Uri GetProxy(Uri destination)
        {
            return _proxyUri;
        }

        public bool IsBypassed(Uri host)
        {
            return false;
        }
    } 

    [StructLayout(LayoutKind.Sequential, CharSet=CharSet.Unicode)]
    public struct CERT_CHAIN_POLICY_PARA {
        public CERT_CHAIN_POLICY_PARA(int size) {
            cbSize = (uint) size;
            dwFlags = 0;
            pvExtraPolicyPara = IntPtr.Zero;
        }
        public uint   cbSize;
        public uint   dwFlags;
        public IntPtr pvExtraPolicyPara; 
    }

    [StructLayout(LayoutKind.Sequential, CharSet=CharSet.Unicode)]
    public struct CERT_CHAIN_POLICY_STATUS {
        public CERT_CHAIN_POLICY_STATUS(int size) {
            cbSize = (uint) size;
            dwError = 0;
            lChainIndex = IntPtr.Zero;
            lElementIndex = IntPtr.Zero;
            pvExtraPolicyStatus = IntPtr.Zero;
        }
        public uint   cbSize;
        public uint   dwError;
        public IntPtr lChainIndex;
        public IntPtr lElementIndex;
        public IntPtr pvExtraPolicyStatus; 
    }

    // Internal SafeHandleZeroOrMinusOneIsInvalid class to remove the dependency on .Net Framework 4.6.
    public abstract class InternalSafeHandleZeroOrMinusOneIsInvalid : SafeHandle
    {
        protected InternalSafeHandleZeroOrMinusOneIsInvalid(bool ownsHandle)
            : base(IntPtr.Zero, ownsHandle)
        {
        }

        public override bool IsInvalid
        {
            get
            {
                return handle == IntPtr.Zero "
2021-08-29 01:55:54,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = a9b4843c-66c7-4ee9-9281-63dfcacd3b90
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.19041.1151
        Runspace ID = ce547b84-3cfb-4a83-b5ec-2408f506cb9e
        Pipeline ID = 177
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSEventViewer\1.0.17\PSEventViewer.psm1
        Command Path = 
        Sequence Number = 224
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""TypeDefinition""; value=""using System;

namespace PSEventViewer
{
    public enum Keywords : long {
        AuditFailure     = (long) 4503599627370496,
        AuditSuccess     = (long) 9007199254740992,
        CorrelationHint2 = (long) 18014398509481984,
        EventLogClassic  = (long) 36028797018963968,
        Sqm              = (long) 2251799813685248,
        WdiDiagnostic    = (long) 1125899906842624,
        WdiContext       = (long) 562949953421312,
        ResponseTime     = (long) 281474976710656,
        None             = (long) 0
    }
}""
"
2021-08-29 01:55:54,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = a9b4843c-66c7-4ee9-9281-63dfcacd3b90
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.19041.1151
        Runspace ID = ce547b84-3cfb-4a83-b5ec-2408f506cb9e
        Pipeline ID = 177
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSEventViewer\1.0.17\PSEventViewer.psm1
        Command Path = 
        Sequence Number = 226
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""TypeDefinition""; value=""using System;

namespace PSEventViewer
{
    public enum Level {
        Verbose       = 5,
        Informational = 4,
        Warning       = 3,
        Error         = 2,
        Critical      = 1,
        LogAlways     = 0
    }
}""
"
2021-08-29 01:55:54,4103,"        Severity = Informational
        Host Name = ConsoleHost
        Host Version = 5.1.19041.1151
        Host ID = a9b4843c-66c7-4ee9-9281-63dfcacd3b90
        Host Application = C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        Engine Version = 5.1.19041.1151
        Runspace ID = ce547b84-3cfb-4a83-b5ec-2408f506cb9e
        Pipeline ID = 179
        Command Name = Add-Type
        Command Type = Cmdlet
        Script Name = C:\Program Files\WindowsPowerShell\Modules\PSWriteExcel\0.1.9\PSWriteExcel.psm1
        Command Path = 
        Sequence Number = 228
        User = DESKTOP-16RETNB\sayed
        Connected User = 
        Shell ID = Microsoft.PowerShell
","CommandInvocation(Add-Type): ""Add-Type""
ParameterBinding(Add-Type): name=""Path""; value=""C:\Program Files\WindowsPowerShell\Modules\PSWriteExcel\0.1.9\Lib\Default\EPPlus.Net40.dll""
"
